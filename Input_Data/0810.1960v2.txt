[usegraphicx,usenatbib,useAMS]mn2e

defs.tex

[Covariance of cross-correlations] Covariance of
cross-correlations: towards efficient measures for large-scale
structure

[ R.~E.~Smith]Robert~E.~Smith^1 res@physik.unizh.ch
^1 Institute for Theoretical Physics, University of Zurich, Zurich CH 8037



document



abstract
We study the covariance of the cross-power spectrum of different
tracers for the large-scale structure. We develop the counts-in-cells
framework for the multi-tracer approach, and use this to derive
expressions for the full non-Gaussian covariance matrix. We show, that
for the usual auto-power statistic, besides the off-diagonal
covariance generated through gravitational mode-coupling, the
discreteness of the tracers and their associated sampling distribution
can generate strong off-diagonal covariance, and that this
becomes the dominant source of covariance as k k_f=2 /L. On
comparison with the derived expressions for the cross-power
covariance, we show that the off-diagonal terms can be suppressed, if
one cross-correlates a high tracer-density sample with a low one.
Taking the effective estimator efficiency to be proportional to
the signal-to-noise ratio ( ), we show that, to probe clustering
as a function of physical properties of the sample, i.e. cluster mass
or galaxy luminosity, then the cross-power approach can out perform
the auto-power one by factors of a few. We confront the theory with
measurements of the mass-mass, halo-mass, and halo-halo power spectra
from a large ensemble of N--body simulations. We show that there is
a significant advantage to be gained from using the cross-power
approach when studying the bias of rare haloes. The analysis is
repeated in configuration space and again improvement is found.
We estimate the covariance matrix for these samples, and find strong
off-diagonal contributions. The covariance depends on halo mass, with
higher mass samples having stronger covariance. In agreement with
theory, we show that the covariance is suppressed for the
cross-power. This work points the way towards improved estimators for
studying the clustering of tracers as a function of their physical
properties.
abstract

keywords
Cosmology: theory -- large-scale structure of Universe
keywords

Introduction

The power spectrum of matter fluctuations is of prime concern in
cosmology, since it contains detailed information about the underlying
world model and provides a method for probing the initial conditions
of the Universe. Moreover, if the statistical properties of the
initial fluctuations form a Gaussian Random Field, as is the case for
most inflationary models, then the power spectrum provides a complete
description for the spatial statistics of the density
field. Consequently, over the last few decades a large fraction of
observational and theoretical effort has been invested in estimating
the power spectrum of galaxies from large redshift surveys and also to
devising methods for extracting cosmological information from the
signal
.

In order to obtain robust cosmological constraints from such data
sets, one, however, requires additional knowledge about the signal
covariance matrix -- or the correlation function of power
fluctuations. Unlike the power spectrum, which is the Fourier
transform the two-point correlation function, the covariance has had
relatively little attention. This mainly stems from the fact that in
order to estimate this quantity from a galaxy survey, or to compute it
theoretically, one is required to investigate the four-point function
of Fourier modes, more commonly the trispectrum of galaxies, and this
is a substantially more complex quantity.

The first study of power spectrum covariance, in the modern context,
was performed by Feldmanetal1994, who showed, under the
assumption of Gaussianity, that the matrix was diagonal and that the
variance per band-power was proportional to the square of the power in
the band [see also][]StirlingPeacock1996. This result gave
impetus to those advocating the use of power spectra for large-scale
structure work, over the simpler two-point correlation function,
, since under these same assumptions possesses correlated
errors .

Later, both Scoccimarroetal1999b and MeiksinWhite1999
independently showed that the real situation was much more complicated
than the Gaussian calculation would lead one to believe. They
recognized that nonlinear gravitational instability would cause
different Fourier modes to become coupled together, thus breaking the
Gaussianity. In Scoccimarroetal1999b, this mode-coupling
behaviour was demonstrated by using higher-order perturbation theory
to calculate the trispectrum and by an analysis of results from an
ensemble of N-body simulations. One direct consequence of this
effect, was that the fractional errors on the dark matter power
spectrum were shown to reach an almost constant plateau on
intermediate to small scales, regardless of the additional number of
Fourier modes [see
also][]ScoccimarroSheth2002,Hamiltonetal2006,RimesHamilton2006,Takahashietal2009. They
also showed that off-diagonal covariance on small scales was
generated, but their results on large scales appeared inconclusive,
owing to small volumes and hence increased sample variance.

MeiksinWhite1999 reached similar conclusions. They also
extended the theoretical analysis to include the covariance in the
power spectrum, arising from the finite sampling of the density field,
referred to as Poisson sampling variance. It is well known that this
is of importance for correctly determining the diagonal errors of the
covariance matrix for rare tracers of the density field, such as
bright galaxies and clusters. Whilst the covariance matrix of the
dark matter power spectrum has been studied in some detail, that of
haloes and galaxies has not received nearly the same level of
attention -- at least not beyond the assumption of linear density
evolution and linear biasing. Notable contributions are:
CoorayHu2001,ScoccimarroSheth2002,Sefusattietal2006,Anguloetal2008a.
However, as we will show for the first time in this work, the
discreteness terms that were neglected by [since they were
mainly studying the dark matter clustering][]MeiksinWhite1999,
inevitably, become the dominant source of off-diagonal error for
discrete tracers of the mass distribution.

Recently, cross-correlation techniques have become an ever more
important tool for extracting information from large-scale structure
data. For instance, in a recent theoretical study,
Smithetal2007 demonstrated, using N-body simulations, that
the cross-power spectrum between dark matter and haloes had several
advantages over the simpler auto-power spectrum method. In particular,
a reduced shot-noise correction and noise properties. This
cross-correlation approach has been further exploited to elucidate the
environmental dependence of halo bias
and recently as a means for
probing the large-scale scale dependence of bias in models of
primordial Non-Gaussianity
. Also,
the cross-correlation approach has recently been applied to real
survey data, to study the intrinsic clustering properties of quasars
in the SDSS photometric redshift catalogue, through cross-correlating
them with the more abundant Luminous Red Galaxy (LRG) sample
. It is therefore of great use to have an
explicit calculation for the covariance of cross-correlations for use
in likelihood analysis. Moreover, the covariance matrix is an
important ingredient for any Fisher matrix parameter forecast, and
hence an essential tool for optimal survey design .

The paper is broken up as follows: In we
develop the standard counts-in-cells framework to calculate the
cross-power spectrum of two different tracers of the large scale
structure. In the analysis, we pay close attention to the assumed
sampling distribution: besides the usual Poisson model, we also
consider the toy-model scenario where one tracer is simply a
sub-sample of the other and results are presented for both cases.
This is instructive, since it is likely that not all galaxies are
equally good tracers of the mass -- in particular those hosted in the
same halo. Then in we derive an expression for
the covariance of the cross-power spectrum, including all non-Gaussian
and finite sampling contributions to the error. Limiting cases are
considered and expressions are also given for band-power averages. We
evaluate the expected covariance signal for several different tracers
of the mass. In we compare the efficiency of
the cross-power approach with that of the simpler auto-power approach.
In the analogous expressions are derived for the
cross-correlation function. In we make a
direct comparison of the theoretical predictions with estimates
measured from the zHORIZON simulations, a large ensemble of
dark matter N-body simulations with total volume
100 . Finally in we summarize our
results and conclude.

Counts-in-cells framework for multiple tracers

Statistics of a single tracer population

Consider a single population of N discrete objects in some large
volume V_ that trace the large-scale structure of the Universe
in some way. Following Peebles1980, we shall assume that these
tracers are Poisson sampled from some underlying smooth density field,
and that the statistics of this underlying field are well described by
a Gaussian Random Field. Hence, on partitioning space into a set of
infinitesimal volume elements V, the probability of finding
N_i galaxies in an element at position vector _i is given by

P(N_i| = n( _i) V) & = & [- ] ^N_iN_i!

& & \
arrayll
n( _i) V & (N_i=1)
1-n( _i) V & (N_i=0)
0 & (N_i>1)
array
. ,

where n( ) is the continuous number density function for tracers
in the volume, which, in the local model for galaxy bias
, is directly related to the
underlying distribution of fluctuations in the CDM; and for the
linearized relation this is simply:
n( )= [1+b ( ) ], where
( )= [ ( )- ]/ is the fractional
over-density in the dark matter relative to the mean density
. The probabilities of finding N_i 2 are higher powers of
the infinitesimal quantity V and so are negligible. It can
now be shown that all of the one-point moments are (m 1):

<N_i^m >_p,s = = <N_i >_p,s
= <n( _i) V >_s = V\ ;

and the central moments of the distribution are (m>1)

<(N_i- )^m >_p,s = <n( _i) V >_s =
V\ \ ,

where in the above we used the notation < >_p,s to
denote an averaging over all possible samplings of the points p and
all points in space s (for brevity we shall simply write
< >).

The two-point moments may also be derived. Consider the joint
probability of finding objects in two disjoint volume elements
V_i and V_j separated by a vector _ij= _i- _j, in
the Poisson sampling model this is given simply by the product of the
independent probabilities (i j):


P(N_i,N_j) & = & P(N_i)P(N_j)\
& = & n( _i)n( _j) V_i V_j \ .


On averaging the two-point moments may be written,

<N^k_i N^m_j > =
^2 V_i V_j [1+ ( _i, _j)] \ ,

where <n( ) >= _i N_i/ =N/ is the
mean number density of tracers and ( _i, _j) is the
two-point auto-correlation function. Hence, correlations are
introduced into the sample, if and only if the points in the
underlying continuous field are correlated.

The auto-power spectrum

We define the Fourier relations for the density field as,


( ) & = & (2 )^3 \,
( ) (-i ) \ ;
( ) & = & 1 \, ( ) (i )\ .


The density field of the discrete counts in cells is written

^d( )= 1 _i
[N_i- <N_i > ] ^D( - _i)\ ,

which on insertion into our definition of the Fourier transform leads to
the discrete sum

^d( )= 1N _i [N_i- <N_i > ]
(i _i) \ .

We may now compute the power spectrum of the discrete set of tracers,

\[
< ^d( _1) ^d( _2) > =
1N^2 _i,j < [N_i- <N_i > ]
[N_j- <N_j > ] > \]

2.4cm e^i _1 _i+i _2 _j \

2.4cm= 1 ^2 _i j
V_i V_j ( _i, _j)
e^i _1 _i+i _1 _j

2.4cm + 1N _i=j
V_i e^i( _1+ _2) _i\ .


The sums over cells can be transformed into volume integrals, and the
double volume integral over the correlation function in the first term
can be simplified by recalling that through statistical homogeneity
( _i, _j)= ( _i- _j,0). We may then make use of the
orthogonality of the Fourier basis functions to evaluate sums of the
type,

_i V_i e^i( _1+ _2) _i = ^K_ _1,- _2 \ .

Hence, after performing these steps and introducing our definition of
the power spectrum as

P( _1) ^K_ _1,- _2
< ( _1) ( _2) >\ ,

we recover the standard result for the power spectrum of discrete
tracers :

P^d(k)=P^c(k)+ 1 \ ,

where P^c is the power spectrum of the underlying continuous field
of tracers. The constant term on the right-hand-side of the equation
is more commonly referred to as the `shot-noise correction' term, and
is the additional variance introduced through discreteness.

Statistics of two tracer populations

We shall now extend the above formalism to the problem of two
different tracer populations, which we shall denote as A and
B. Let the total number of objects in samples A and B be N_A and
N_B, and the numbers of each type of object in the ith cell be
N_A,i N_A( _i) and N_B,i N_B( _i),
respectively. Likewise the mean number densities are _A and
_B. We now consider two cases for the sampling distributions,
these are:

enumerate

Non-overlapping tracers. A and B are both independent
Poisson samples of the underlying continuous density field. In this
case the joint probability distribution for obtaining objects of
types A and B in a single cell is:

P(N_A,i,N_B,i) = P(N_A,i| _A)P(N_B,i| _B)\ ;


\
arrayll
1- [n_A( )+n_B( ) ] V & (N_A=0,N_B=0)
n_A( ) V & (N_A=1,N_B=0)
n_B( ) V & (N_A=0,N_B=1)
0 & (N_A 1,N_B 1) \ .
array
.


The one-point cross-moments are then calculable (m 1, k 1),

<N^m_A,i N^k_B,i >=0 \ ;

and so too the central moments:

< (N_A,i - <N_A,i > )^m
(N_B,i- <N_B,i > )^k >=0 \ .

As in Eq.~(), the two-point cross-moments may also
be derived and these are (i j):


<N^m_A,i N^k_B,j >= _A _B V_i V_j
[1+ ^AB( _i, _j)] \ ,\


where ^AB is the two-point cross-correlation function of the
tracers A and B.
3mm

Overlapping tracers. A is a Poisson sample of the
underlying continuous density field, and B is a sub-sample of
A. This time the joint probability distribution for obtaining
objects of types A and B is written:

P(N_A,i,N_B,i) = P(N_A,i| _A)P(N_B,i|N_A,i)\ .

The conditional probability P(N_B,i|N_A,i) is the key object of
interest here, and as a simple illustrative example we will take this
as:

P(N_B,i|N_A,i)=
\
arrayll
1 & (N_B=0|N_A=0)
a & (N_B=1|N_A=1)
1-a & (N_B=0|N_A=1)
0 & (N_B>1|N_A 1)\ ,
array
.


where we shall fix a N_B/N_A. Again, the one-point
cross-moments are also calculable for this sampling model,

<N^m_A,i N^k_B,i >= a\, n_A V = n_B V\ ;

and so too the central moments,

<
(N_A,i - <N_A,i > )^m
(N_B,i - <N_B,i > )^k
>= n_B V\ .

Similarly, the two-point cross-moments are also calculable,


<N^m_A,iN^k_B,j >= _A _B V_i V_j
[1+ ^AB( _i, _j)] \ .\


enumerate

The cross-power spectrum

We may also compute the cross-power spectrum of tracers A and B, and
for both the non-overlapping (case i) and overlapping (case ii)
sampling distributions. The Fourier modes for tracers A and B can be
written,

^d_T(k)= 1N_ T
_i [N_ T( _i)- <N_ T,i > ]
(i _i) \ ,

where T=\A,B\ denotes the tracer type. As for the
auto-spectrum, we shall define the cross-power spectrum, as

P_AB( _1) ^K_ _1,- _2
< _A( _1) _B( _2) > \ .

Following now the steps in , but this time using
the statistics for the counts-in-cells as given in the previous
section, we find that the cross-power of discrete tracers A and B
obeys the relation:

P^d_AB(k)=P^c_AB(k)+ \ 1 _A \ \
,

where P^c_AB is the cross-power spectrum of the underlying
continuous fields. This expression is almost identical to the result
for the auto-spectrum (Eq.~), however we
emphasize an important difference, the constant term is enclosed by
curly brackets. In this paper \ \ shall have the special
meaning that this term only appears when there is an overlap between
samples A and B, as in sampling case(ii), otherwise this term is
exactly zero [see][]Peebles1980. We note that this
notation shall be exploited throughout the rest of the paper, to
represent the results from both sampling distributions with a single
equation. More intuitively, the appearance of the constant term in the
cross-power spectrum warns us that, if the two samples are not truly
independent, then we should expect some finite sampling correction.

Covariance of the cross-power spectrum

We now turn to the calculation of the full non-Gaussian covariance of
the cross-power spectrum for discrete tracers A and B. Note that,
when considering sampling case ii, and in the limit that N_A=N_B,
then we shall recover the standard covariance relations for the
auto-power spectrum .

Definition of the covariance

To begin, we define the covariance, per mode, of the cross-power
spectrum for discrete tracers A and B as,

C_AB^d & &
Cov [P^d_AB( _1),P^d_AB( _2) ] &
= & <P^d_AB( _1)P^d_AB( _2) >-
<P^d_AB( _1) > <P^d_AB( _2) > \ .

On inserting the definition for the cross-power spectrum,
P_AB < _A( _1) _B(- _1) >,
and making use of Eq.~() in the second term on the
right-hand-side, then we obtain


C_AB^d & = &
^2 < ^d_A( _1) ^d_B(- _1) ^d_A( _2) ^d_B(- _2) >
& & -
(P^c_AB( _1)+ \ 1 _A \ )
(P^c_AB( _2)+ \ 1 _A \ )\ .


Thus we see that in order to compute the covariance of the cross-power
spectrum, it is also necessary to evaluate the four-point function of
Fourier modes, or more commonly the trispectrum.

Evaluating the discrete cross-trispectrum

Using the counts-in-cells approach, the four point cross-correlation
function of Fourier modes can be written explicitly as,

< ^d_A( _1) ^d_A( _2) ^d_B( _3) ^d_B( _4) >
= 1N_A^2 1N_B^2 _i,j,k,l e^i _1 _i+ +i _4 _l

1cm
<
(N_A,i- <N_A,i > )
(N_A,j- <N_A,j > ) .

1cm
.
(N_B,k- <N_B,k > )
(N_B,l- <N_B,l > )
> \ \ .

Thus we find that in order to evaluate the trispectrum, we are in turn
required to evaluate the four-point cross-correlation function of
counts-in-cells. Again, following Peebles1980, we break this
quadruple sum into five types of terms, each of which arises from a
particular partitioning of the indices (i,j,k,l). Full details are
presented in the following subsections, those not wishing to be
embattled at this stage should skip ahead to .

Terms (i j k l)

Terms in the sum with these indices, correspond to contributions to
the product from the connected four-point correlation function of the
field. These terms can be rewritten as,

< (N_A,i- <N_A,i > )
(N_B,l- <N_B,l > ) >
=
_A^2 _B^2 V_i V_l
1cm
[ _ijkl^AABB+
^AA_ij ^BB_kl+
^AB_ik ^AB_jl+
^AB_il ^AB_jk ]
\ ,

where for convenience we have introduced the abbreviated notation for
the two-, three- and four-point correlation functions:

_ij ( _i, _j) \ ; \
_ijk ( _i, _j, _k) \ ; \
_ijkl ( _i, _j, _k, _l) \ .

On inserting the above expression into Eq.~(),
transforming the sums over cells to volume integrals, and using the
statistical homogeneity of the correlation functions, we obtain the
following expression,


^2 < ^d_A( _1) ^d_B( _4) >
= 1 T_AABB( _1, _2, _3, _4) ^K_ _1+ + _4,0

1cm +
P_AA( _1)P_BB( _3)
^K_ _1,- _2 ^K_ _3,- _4

1cm +
P_AB( _1)P_AB( _2)
^K_ _1,- _3 ^K_ _2,- _4

1cm +
P_AB( _1)P_AB( _2)
^K_ _1,- _4 ^K_ _2,- _3\ ,


where the irreducible or connected trispectrum of the underlying
continuous density field has been defined as,
T( _1, , _4) ^3
< ( _1) ( _4) >_c
^K_ _1+ _4,0. This obeys a Fourier relation with the
irreducible four-point correlation function _ijkl.

Terms (i j k = l) + perms.

There are six types of term that arise from the equivalence of two of
the indices, and in order to evaluate these, we are required to deal
with products of the form,

<
(N_A,i- <N_A,i > )
(N_A,j- <N_A,j > )
(N_B,k- <N_B,k > )^2
>


=
<
(N_A,i- <N_A,i > )
(N_A,j- <N_A,j > )
N_B,k > \ ,


= _A^2 _B V_i V_j V_j
[ _ij^AA+ _ijk^AAB ] \ ,


where the second equivalence follows from the rules for the
cross-moments . Hence, on repeating this
procedure for all possible ways of equivalencing two indices we
arrive at six expressions. Then, on following a procedure similar to
the evaluation of the cross-power spectrum, and on introducing the
bispectrum B as,

B( _1, _2) ^K_ _1+ _2+ _3,0 ^2
< ( _1) ( _2) ( _3) > \ ,

and noting that B and are Fourier duals, we find that these
terms can be written:


^2 < ^d_A( _1) ^d_B( _4) >=

\[
[
1 _BP_AA( _1)+ 1 _AP_BB( _3) ]
^K_ _1,- _2
^K_ _3,- _4+
\]
\[
\ 1 _A [P_AB( _1)+P_AB( _2) ]
[
^K_ _1,- _4 ^K_ _2,- _3
+ ^K_ _1,- _3 ^K_ _2,- _4
] \
\]
\[
+ [ 1N_BB_AAB( _1, _2) + 1N_AB_ABB( _3, _4) ]
^K_ _1+ + _4,0
\]

+ \ 1N_A
[
B_ABB( _1, _3) +B_ABB( _1, _4)+B_ABB( _2, _3) . .


. . +B_ABB( _2, _4) ]
^K_ _1+ + _4,0 \
\ ,


where B_ABB and B_AAB are the cross-bispectra of the fields A
and B.

Terms (i=j k = l) + perms.

There are three terms of this form that arise in the quadruple sum,
and theses involve evaluation of quantities of the form:

<
(N_A,i- <N_A,i > )^2
(N_B,k- <N_B,k > )^2
> = <N_A,iN_B,k >


1cm= _A _B V_i V_k
[1+ _ik^AB ] \ ,


where again we have used the relations for the cross-moments from
. On repeating this procedure for the other two
terms, and repeating the analysis as before, we find that these types
of terms can be written together as,


^2 < ^d_A( _1) ^d_B( _4) >=
^K_ _1,- _2 ^K_ _3,- _4 _A _B

\[
+ \ 1 _A^2
[
^K_ _1,- _3 ^K_ _2,- _4+
^K_ _1,- _4 ^K_ _2,- _3
] \
\]

+ 1 _A _B P_AB( _1+ _2) ^K_ _1+ + _4,0

+
\
1 _A^2 [P_BB( _1+ _3)+P_BB( _1+ _4) ]
^K_ _1+ + _4,0 \
\ .


Terms (i = j = k l) + perms.

There are four possible types of term that arise from this combination
of indices and each of these requires us to evaluate a product like:

<
(N_A,i- <N_A,i > )^2
(N_B,i- <N_B,i > )
(N_B,l- <N_B,l > )
>


1cm= < N_B,i (N_B,l- <N_B,l > ) >


1cm= _B^2 _il^BB V_i V_l\ .


Hence, on repeating this for the four possible arrangements of the
indices, and on using the methods described for the previous terms,
we find that all of these terms reduce to the following expression:

\[
^2 < ^d_A( _1) ^d_B( _4) >=
\ 1 _A _B [
P_AB( _1)+
P_AB( _2)
]
.
\]

1cm .
+ 1 _A^2
[

P_BB( _3)+
P_BB( _4) ]
\ ^K_ _1+ + _4,0


Terms (i=j=k=l)

There is only one form for this type of term in the quadruple sum,
and to evaluate it we are required to compute the quantity,

<
(N_A,i- <N_A,i > )^2
(N_B,i- <N_B,i > )^2 > =
<N_B,i >= _B V_i \ .

Hence, this has the form


^2 < ^d_A( _1) ^d_B( _4) >
= \ 1 _A^2 _B V_ \ ^K_ _1+ + _4,0\ .


Expressions for the cross-power covariance

The summation of
Eqns~(,\,,\,,\,,\,)
gives the complete description of all the terms entering the
cross-trispectrum of Fourier modes for samples A and B. We may now use
this to obtain the full non-Gaussian covariance of the cross-power
spectrum in two different modes _1 and _2. To do this we
simply take
Eqns~(,\,,\,,\,,\,),

and set the arguments of the wave modes to be

( _1, _2, _3, _4)
( _1, _2,- _1,- _2)\ .

This gives us the quantity
< ^d_A( _1) ^d_B(- _1) ^d_A( _2) ^d_B(- _2) >.
Hence, the covariance is given by:

C^d_AB= 1 T_AABB( _1, _2,- _1,- _2)

+ ( P_AA( _1)+ 1 _A ) (P_BB( _2)+ 1 _B )
^K_ _1,- _2

+ ( P_AB( _1)+ \ 1 _A \ )
( P_AB( _2)+ \ 1 _A \ )
^K_ _1, _2+

B_AAB( _1, _2)N_B+ 1N_A [
B_ABB(- _1,- _2)+ \ B_ABB( _1,- _2) . .

\[ . . + B_ABB( _2,- _2)
+B_ABB( _2,- _1)+B_ABB( _1,- _1)
\ ]
\]
\[
+ P_AB( _1+ _2) _A _B
+ \
1 _A^2 [P_BB( 0)+P_BB( _1- _2) ]
\
\]
\[
+ \
1 _A^2 [P_BB(- _1)+P_BB(- _2) ]
\
\]

+ \
1 _A _B [P_AB( _1)+P_AB( _2) ] \+
\ 1 _A^2 _B V_
\ \ .


Again, we remind the reader that the terms in curly brackets vanish
for the case where samples A and B have no overlap. It should also be
noted that when samples A and B are equivalent, then we recover the
expressions for the covariance of the auto-power spectrum
.

figure*

[width=8cm]FIGS/CorrMatrix.13.70.dat.eps 1cm
[width=8cm]FIGS/CorrMatrix.15.00.dat.eps
Theoretical predictions for the halo-halo auto-power
spectrum correlation matrix as a function of wavenumbers k_i and
k_j. Here all of the covariance is generated by the discreteness
terms and all non-Gaussian terms generated through gravitational
instability have been set to zero, i.e. T_c=B_c=0. Left
panel: dark matter haloes with masses
M [1.0 10^13,2.0 10^13] . Right panel:
dark matter haloes with masses
M [1.0 10^15,2.0 10^15] .

figure*

Band-power average covariance

The above formula gives us the full expression for the covariance in
the cross-power spectrum per Fourier mode. In practice, the power is
estimated by averaging over all wavemodes in thin spherical shells in
k-space -- band-powers. The band-power average power spectrum can be
written,

P_AB(k_i)= V_s,i _V_s,i \,
< _A( ) _B(- ) > \ ,

where the average is over the k-space shell V_s, of volume

V_s,i= _k_i- k/2^k_i+ k/2
=4 ^2 k_i^2 k [1+ 112
( kk_i )^2 ]\ .

The discretized form for the band-power is,

P_AB(k)= N_k _j=1^N_k
< _A( _j) _B(- _j) > \ ,

where N_k=V_s(k)/V_k is the total number of modes in the shell.
V_k=k_f^3 is the fundamental k-space cell-volume and k_f=2 /L
is the fundamental wavemode.

Likewise, the band-power averaged covariance can be written,


C^d_AB[k_i,k_j] & &
1V_s,iV_s,j
_V_s,i,V_s,j -0.3cm _1 _2 \, C^d_AB[ _1, _2]
\ .

To obtain the full non-Gaussian band-power covariance, one then
inserts Eq.~() into the above expression, and
this leads to,


C^d_AB[k_i,k_j] & = & 1 T_AABB[k_i,k_j]

& & -2cm + 1N_k [ ( P_AA(k_i)+ 1 _A )
( P_BB(k_j)+ 1 _B ) .

& & -2cm + . ( P_AB(k_i)+ \ 1 _A \ )
( P_AB(k_j)+ \ 1 _A \ ) ]
^K_k_i,k_j

& & -2cm + B_AAB(k_i,k_j)N_B+
B_ABB(k_i,k_j)N_A
+ \ 2N_A B_ABB(k_i,k_j) \

& & -2cm + P_AB[k_i,k_j] _A _B
+ \
1 _A^2 [ P_BB[k_i,k_j] ]
\

& & -2cm + \
1 _A _B [ P_AB(k_i)+ P_AB(k_j) ] \


& & -2cm + \ 1 _A^2 [ P_BB(k_i)+ P_BB(k_j) ]
\ + \ 1 _A^2 _B V_
\ \ .


where the bin averaged trispectrum and bispectrum are:


T[k_i,k_j] & &
_V_s,i,V_s,j
_1V_s,i _2V_s,j T( _1, _2,- _1,- _2)\ ;
B[k_i,k_j] & &
_V_s,i,V_s,j
_1V_s,i _2V_s,j B( _1, _2,- _1- _2)\ ;


and where we introduced the function,


P[k_i,k_j] & &
_V_s,i,V_s,j
_1V_s,i _2V_s,j P( | _1- _2 |)\ ,
& = &
_V_s,i,V_s,j
_1V_s,i _2V_s,j P( | _1+ _2 |)\ ,


We may now consider a number of interesting limiting cases of the
above expressions. Firstly, in the very large-scale limit
\k_i,k_j\ 0, and we have that
P 0, B 0 and
T 0, and the covariance becomes

C^d_AB[k_i,k_j]
1N_k_i 1 _A _B ^K_k_i,k_j
+ \ 1 _A^2 _B V_ \\ .


In the small-scale limit \k_i,k_j\ k_f=2 /L, and again we have that
P 0, B 0 and
T 0, and also N_k 1, hence

C^d_AB[k_i,k_j]
\ 1 _A^2 _B V_ \ \ .

The correlation matrix C is defined as the covariance
matrix normalized by its diagonal components, i.e.

C^d_AB[k_i,k_j]= C^d_AB[k_i,k_j]
C^d_AB[k_i,k_i] C^d_AB[k_j,k_j]\ ,

and C[k_i,k_i]=1 and -1 C[k_i,k_j] 1.
Thus for (i j) and in the large-scale limit, we find


C^d_AB[k_i,k_j] & &
[
( _A )^2N_k_iN_k_j
+ _A ( N_k_i+N_k_jN_k_iN_k_j )+1
]^-1/2\ .
& & N_k_iN_k_j _A 1 \ ,

where the second equality obtains from assuming
_A . Conversely, in the small-scale limit we find

C^d_AB[k_i,k_j] & & 1 .

These last two expressions are important results. The first informs us
that if one computes the auto-power spectrum of a discrete sampling of
the density field, then for a standard CDM power spectrum, the
covariance matrix is diagonal on large scales provided
1. However on small scales all of the Fourier modes
inevitably become perfectly correlated, and this is completely
independent of any Non-Gaussian terms generated through gravitational
instability. On the other hand, if there is no overlap between samples
A and B, then there will be no off-diagonal covariance, since
Eq.~() vanishes.

We may demonstrate these statements more clearly by taking the Gaussian
limit of Eq.~(),


C^d_AB[k_i,k_j] & = &
1N_k
[
( P_AA(k_i)+ 1 _A )
( P_BB(k_j)+ 1 _B )
.

& & -2.1cm +
.
( P_AB(k_i)+ \ 1 _A \ )
( P_AB(k_j)+ \ 1 _A \ )
] ^K_k_i,k_j

& & -2.1cm +
P_AB[k_i,k_j] _A _B +
\
1 _A^2 [ P_BB[k_i,k_j] ]
\

& & -2.1cm +
\ 1 _A^2 [ P_BB(k_i)+ P_BB(k_j) ]
\

& & -2.1cm +
\
1 _A _B [ P_AB(k_i)+ P_AB(k_j) ]
\+
\ 1 _A^2 _B V_ \
\ .


For the case where samples A and B are identical, then the above
expressions reduce to,


C^d[k_i,k_j] \!\!\! & = &
2N_k_i
( P(k_i)+ 1 )^2 ^K_k_i,k_j

& + & 0cm
2 ^2 [ P[k_i,k_j]+ P(k_i)+ P(k_j) ]
+ 1 ^3 V_
\ .


Finally, since it will be of use later, we may also take the limit
_A , giving


C^d_AB[k_i,k_j] & = &
1N_k
[
( P_AA(k_i)+ 1 _A )
( P_BB(k_j)+ 1 _B )
.

& & -2.1cm +
.
( P_AB(k_i)+ \ 1 _A \ )
( P_AB(k_j)+ \ 1 _A \ )
] ^K_k_i,k_j \ .


and for A equivalent to B,


C^d[k_i,k_j] \!\!\! & = &
2N_k_i
( P(k_i)+ 1 )^2 ^K_k_i,k_j \
\ .


Figure~ presents the correlation matrix for the
halo-halo auto-power spectrum generated using
Eq.~(). In the left and right panels we
show the results for haloes with masses in the range
M [1.0,2.0] 10^13 and
M [1.0,2.0] 10^15 , respectively. We evaluate the
average bias and halo number density within each mass bin using the
models, and we find,
= [1.87 10^-4,1.12 10^-7 ] h^3~
Mpc^-3 and b= [1.30, 5.85 ], for the two bins
respectively, and we take =(1500)^3 . In both cases the
matrix becomes fully correlated and the rare sample shows a much
stronger correlation on larger scales than the higher abundance lower
mass halo sample. On the other hand, if we were to compute the
correlation matrix for the cross-power spectrum of the two halo
samples, then we would predict that the correlation matrix would be
equivalent to the identity matrix.

Before we leave this section, it is interesting to note that, in the
pure Gaussian limit, i.e. _TP_T 1, then the fractional
variance in the cross-power is not simply dependent upon the number of
available modes, but also the cross-correlation coefficient:
r_AB(k) P_AB(k_i)/ P_AA(k_i)P_BB(k_i). This can
be seen directly from Eq.~(),

( _ P_AB P_AB )^2= 1N_k
( 1r_AB^2+1 )\ .


The corresponding expression for the auto-power spectrum is
_P/ P= 2/N_k
k^-1 ^-1/2. However, when r_AB=1, then there is no
difference and the fractional error scales with the survey volume in
the usual way. In , we shall show that for
haloes and dark matter on the largest scales, the cross-power approach
offers only a modest improvement over the auto-power method, implying
that r_AB 1.

Efficiency of estimators

Comparing estimators

One might ask the following question: when should one apply the
cross-power spectrum approach, instead of the usual auto-power
spectrum approach? In this section we shall attempt to answer this
question. The main advantages of the cross-power approach are most
apparent when one probes the dependence of a given sample of tracers
as a function of some physical parameter, i.e. the luminosity
dependence of clustering or the mass dependence of the clustering of
clusters. This statement can be more directly quantified if we
consider the concept of estimator efficiency.

If we have two unbiased estimators E_1 and
E_2, then the most efficient estimator of the two, is said to be
the one with the smallest variance: i.e. if
Var[E_1]< Var[E_2], then E_1
will be considered to be a more efficient estimator than
E_2 . We need to modify this concept slightly since in
comparing the cross- and auto-power spectra we are not estimating the
same thing, owing to the clustering bias. Instead we shall define the
effective efficiency of the estimator through the signal-to-noise
(hereafter ) ratio: i.e. E_1 will be considered to
be a more efficient estimator than E_2 if
E_1/ Var[ E_1]> E_2/
Var[ E_2]>. Or in other words the estimator with the
largest will be the most efficient estimator.

On taking the limit _A for
Eqns~() and
(), the covariance matrices are
diagonal and so we may write the for the auto- and cross-power
spectra as:


( )_jj^2N_k -0.2cm & = -0.2cm &
12 _j^2 [1+ _j^2 ]
\ ;
( )_ij^2N_k -0.2cm & = -0.2cm &
[ _i _jr_ij^2

( _i+1 ) ( _j+1 )+( _i _jr_ij
+ \ \)^2

]
\


where we have introduced the following quantities,


_i & & _i P_ii \ ;
r^2_ij & = & P^2_ij/P_iiP_jj \ ;
^2 & & _j/ _i\ .


where we have taken the index i to denote the high density sample
A, and j to denote the low density sample B.

Taking the ratio of the above expressions, gives us a simple test for
the relative efficiency of the estimators,



( )_ij^2 ( )_jj^2 & = &
2r_ij^2 _i _j
& &
[ (1+ _j)^2(1+ _i)(1+ _j)+( _i _jr_ij
+ \ \)^2 ]
\

and we see that the relative efficiency does not depend explicitly on
the number of available modes, nor the survey volume.

To proceed further we must specify samples i and j in more
detail. Let us consider the case where sample i is obtained from a
set of unbiased high density objects and where sample j is obtained
from a set of highly biased but rare objects. For this situation we
have, _i _j. Hence, 0. Further, we
shall assume that _i _j. Hence, Eq.~()
simplifies to,

( )_ij^2 ( )_jj^2

2r_ij^2 [ _j^2+2 _j+1 _j^2(1+r_AB^2)+ _j ]\
.

On assuming that r_AB 1, we finally find that



( )_ij^2
( )_jj^2
[ 2 _j^2+4 _j+22 _j^2+ _j ]
> 1\ .

This means that for examining the clustering properties of rare
samples of objects, it is more efficient to cross-correlate them with
a high-density sample, rather than to compute their auto-power
spectrum.

Example: Improving estimates of cluster bias

Let us now provide a more concrete example. Consider a sample of dark
matter clusters and suppose that we have both the redshift and an
unbiased estimate of the cluster mass, i.e. through either weak
lensing, the Sunyaev-Zel'Dovich effect etc., and that the clusters
span the mass range M [10^11,5 10^15 ] . We
are interested in exploring the bias as a function of cluster mass,
perhaps for use in constraining primordial Non-Gaussianity as in
Slosaretal2008. The sample may be sub-divided into mass bins
and one may measure the auto-power spectrum of each mass bin and also
the cross-power spectra of the different mass bins.

Figure~ shows how the relative as given by
Eq.~(), varies as a function of the mass bins i, and
j. Note that in the figure i and j represent the rows and
columns of the matrix, respectively. When i<j, then we find that
there are significant advantages to be gained from computing the
cross-power spectrum as opposed to the auto-power spectrum especially
for the case of high mass haloes. For the case where i>j, then,
naturally, the cross-power spectra are not optimal measures compared
to the auto-spectrum.

Covariance of the cross-correlation function

As a corollary to our study of the cross-power spectrum, we extend our
analysis to encompass the covariance of the cross-correlation
function. We note that the auto-correlation covariance of dark matter
and haloes on scales relevant for the Baryonic Acoustic Oscillations
(r 100 ), was recently investigated in detail by
Smithetal2008a and Sanchezetal2008. Here we perform a
similar study for the cross-correlation function.

In direct analogy with the analysis of power spectrum band-powers, we
may define the band averaged cross-correlation function as,

^AB( _i) = 1V_s(r_i) _V_s(r_i) \,
^AB(r) = (2 )^3 P^AB(k) j_0(kr_i)


where V_s is the radial shell of thickness r, over which
the average is performed and this has volume,

V_s,i=4 r_i^2 r [1+ 112
( rr_i )^2 ]\ .

For the second equality in Eq.~(), we have made use of
the fact that P are Fourier dual, and we have
defined the zeroth order bin-averaged spherical Bessel function as,

j_0(kr_i)
.r^2j_1(kr) |_r_1^r_2
r_i^2k r [1+ 112 ( rr_i )^2 ] \ \ \ ;
\ arrayl
r_2 = r_i+ r/2
r_1 = r_i- r/2 array .


with j_1(x) x/x^2- x/x being the 1st order spherical
Bessel function. Similar to the bin averaged covariance for the power
(c.f. Eq.~), we may also define the bin averaged
cross-correlation covariance between bins i and j,


C^d_ ^AB & &
Cov [ ^AB_i, ^AB_j ]
& = & 1V_s,iV_s,j
_V_s,i,V_s,j _1 _2 \, C^d_ ^AB
\ .

where C^d_ ^AB=
Cov [ ^AB( _1), ^AB( _2) ]. On inserting our
expression for the bin averaged correlation function then we may
rewrite the above expression as,


C^d_ ^AB =
_1(2 )^3
_2(2 )^3
j_0(k_1r_i) j_0(k_2r_j) C^d_P_AB\ .


Thus, the cross-power covariance also gives us the cross-correlation
covariance. It should also be noted that, even if C^d_P_AB is
diagonal, then C^d_ ^AB is not, since the spherical
Bessel functions in the integrand effectively smooth the information
across different scales.

The full non-Gaussian contributions to the correlation covariance can
be calculated by substituting Eq.~() into the
above expression. On taking the continuum limit for the Kronecker
delta symbols, i.e. ^K_ _1, _2
^D( _1- _2)(2 )^3/ , rewriting the spherical Bessel
functions as,

j_0(kr)= 14 d _ (-i )\ ,

and using the Fourier relations between the N-point correlation
functions and poly-spectra, we then find that


C^d_ ^AB -0.2cm
& = & -0.2cm
_V_s,iV_s,j _1V_s,i _2V_s,j

_AABB( _1+ , _2, )

& + & -0.2cm
_V_s,iV_s,j _1V_s,i
_jV_s,j
[ _AA( ) _BB( _1+ _2+ ) .

& + & . _AB( ) _AB( _1+ _2+ ) ]

& + & -0.2cm
1 _V_s,iV_s,j _1V_s,i
_jV_s,j
[ 1 _B _AA( _1+ _2) .

& + & -0.2cm
. 1 _A _BB( _1+ _2)
+ \ 2 _A _AB( _1+ _2) \
]

& + & -0.2cm
[ 1 _A _B+ \ 1 _A^2 \ ]
^K_i,j V_s(i)+ _AAB(r_i,r_j)N_B

& + & -0.2cm
1N_A [ _ABB(r_i,r_j)+
\ 2 _ABB(r_i,r_j) \ ]

& + & -0.2cm
_AB(r_j) _A _B V_s,i ^K_i,j
+ \
_BB(r_i) _A^2 V_s,i ^K_i,j
\

& + & -0.2cm
\
1 _A _B
[ _AB(r_i)V_s,j ^K_j,1 +
_AB(r_j)V_s,i ^K_i,1 ]
\

& + & -0.2cm
\ 1 _A^2 _B
^K_i,1V_s,i
^K_j,1V_s,j
\


Again we may take the Gaussian ( = =0) limit of the full
expression and we find

C^d_ ^AB & = & 1
(2 )^3 j_0(kr_i) j_0(kr_j)


& & [
(P_AA(k_1)+ 1 _A )
(P_BB(k_1)+ 1 _B ) .

& + & . (P_AB(k_1) + \ 1 _A \ )^2 ]


-0.2cm
& + & _AB(r_j) _A _B V_s,i ^K_i,j
+ \
_BB(r_i) _A^2 V_s,i ^K_i,j
\

& + & \
1 _A _B
[
_AB(r_i)V_s,j ^K_j,1 +
_AB(r_j)V_s,i ^K_i,1 ]
\

& + & \ 1 _A^2 _B
^K_i,1V_s,i
^K_j,1V_s,j
\ \ .


The first term is the usual Gaussian plus Poisson expression and this
leads to off-diagonal covariance through the spherical Bessel
functions. The second and third terms contribute only to the diagonal
variance, however the fourth and fifth terms contribute to the
off-diagonal variance along lines of zero lag and the last contributes
only to the zero lag term. Therefore in the Gaussian limit, whilst the
covariance matrix for the correlation functions is in general
non-diagonal, the terms associated with the Poisson noise that lead to
off-diagonal terms in the power spectrum covariance, do not generate
off-diagonal covariance in the correlation function. However, in the
more general case we see that additional off-diagonal terms can be
generated when we have non-zero and . Furthermore, for
the case of the cross-correlation function of a non-overlapping
samples, then all of the terms in curly brackets vanish, and the
covariance is significantly reduced.

Finally, on taking the limit _A the
covariance between band averages of the cross-correlation function
reduces to,

C^d_ ^AB
& & 1 (2 )^3
j_0(kr_i) j_0(kr_j) (k)
& + & ^K_i,j V_s(r_i)
[ 1 _A _B+ \ 1 _A^2 \ ]\ ,


and where we introduced the useful function

\[
(k) = P_AA(k_1)P_BB(k_1)+
[ P_AA(k_1) _B+ P_BB(k_1) _A ]
\]

1cm
+P_AB^2(k_1)+ \ 2P_AB(k_1) _A \\ .

Lastly, in the limit where _A _B, we recover the
usual expression in the Gaussian limit
.

table*

Parameters for the zHORIZON simulations -- Columns are:
density parameters for matter, dark energy and baryons; the equation
of state parameter for the dark energy P_w=w _ w;
normalization and primordial spectral index of the power spectrum;
dimensionless Hubble parameter H_0=h 100 [ ]; number of
particles, box size, particle mass, number of realizations, and total simulation
volume, respectively.

tabularc|cccccccccccc

Simulation & _m & _w & _b & w_0 &
_8 & n & h & N & L[ ] & m_ p[ ] & N_ sim & V_ tot[ ]

zHORIZON & 0.25\ & 0.75 & 0.04 & -1 & 0.8 & 1.0 & 0.7
& 750^3 & 1500.0 & 5.55 10^11 & 30 & 101.25
tabular
table*

Comparison with N-body simulations

In this section we compare the counts-in-cells predictions for the
covariance matrices of the mass-mass, halo-mass and halo-halo power
spectra and correlation functions with results from a large ensemble
of numerical simulations.

The zHORIZON simulations

The Z\"urich Horizon, `` zHORIZON'', simulations are a large
ensemble of pure cold dark matter N-body simulations (N_
sim=30,\, N_ part=750^3), performed at the University of
Z\"urich on the zBOX2 and zBOX3 super-computers. The
specific aim for these simulations is to provide high precision
measurements of cosmic structures on the scales of the order
100 and to also provide insight into the rarest fluctuations
within the LCDM model that we should expect to find within the
observable universe -- the Horizon Volume.

Each numerical simulation was performed using the publicly available
Gadget-2 code , and followed the nonlinear
evolution under gravity of N equal mass particles in a comoving cube
of length L. All of the simulations were run within the same
cosmological model, and the particular choice for the parameters was
inspired by results from the WMAP experiment
-- the
parameters for the simulations are listed in
Table~. The transfer function for the simulations was
generated using the publicly available cmbfast code
, with high sampling of
the spatial frequencies on large scales. Initial conditions were lain
down at redshift z=50 using the serial version of the publicly
available 2LPT code .

Dark matter halo catalogues were generated for all snapshots of each
simulation using the Friends-of-Friends (FoF) algorithm
, with the linking-length parameter set to the
standard b=0.2 -- b is the fraction of the inter-particle
spacing. For this we used the fast parallel B-FoF code, kindly
provided by V.~Springel. The minimum number of particles for which an
object was considered to be a bound halo, was set to 30
particles. This gave a minimum host halo mass of 10^13
M_ /h.

figure*

[width=13cm]FIGS/Error_Pow_MM_HM_HH_Real.ps
Comparison of the fractional variance in the halo and
mass power spectra measured from the zHORIZON simulations
with theoretical predictions. The three panels show the square
root of the bin averaged diagonal elements of the covariance
matrix, ratioed to the mean power in the bin as a function of the
spatial frequency. From top to bottom, the panels show results for
the halo-halo, halo-mass and mass-mass power spectra. In all
panels, solid points denote results obtained after a standard shot
noise subtraction, and corresponding open points denote results
prior to shot-noise subtraction. Dash lines represent the pure
Gaussian predictions. Solid lines denote theoretical predictions
from the Gaussian plus standard Poisson noise theory. Dot-Dash
lines denote the results from Eqs~()
and (). In the top two panels, the
(red) point symbols and (blue) star symbols denote haloes with
masses in the range (M>1.0 10^14 ) and
(1.0 10^13<M<2 10^13 ), respectively.

figure*

Results: band-power variances

Figure~ shows the results for the mean fractional
error in the mass-mass (bottom panel), halo-mass (middle panel), and
halo-halo (top panel) power spectra, as measured from the
zHORIZON simulations. The spectra were estimated for each
simulation using the standard methods
: particles and halo
centres were interpolated onto a 1024^3 cubical mesh, using the CIC
algorithm ; the Fast Fourier Transform of
the discrete mesh was computed using the FFTW libraries ;
the power in each Fourier mode was estimated and then corrected for
the CIC charge assignment; these estimates were then bin averaged in
spherical shells of thickness the fundamental frequency.

The halo-halo and halo-mass spectra were estimated for six bins in
halo mass. The thickness of the mass bins was determined by estimating
the in each bin, and demanding that it should be in excess of
20. In the figure we show the errors for an experiment of volume
3.4 . For clarity, we only present results for the
highest mass bin (M> 10^14 , red point symbols) and for the
lowest mass bin (10^13 <M<1.38 10^13 , blue star
symbols) in our sample. The mean number densities in these bins are
_ h=\2.42,8.01\ 10^-5 , respectively. The
mass-mass and halo-halo power spectra were both corrected for
shot-noise by subtraction of 1/ = /N and 1/ _
h= /N_ halo, respectively.

In the figure, the results for the shot-noise corrected and
uncorrected spectra are represented as filled and empty symbols,
respectively. The halo bias parameters were estimated from the
cross-power and the shot-noise corrected auto-power spectrum
b=(b^ h _ NL,b^ hh_ NL) following the
method in Smithetal2007. The measured values were found to be
b=(2.803 0.015,3.110 0.015) and
b=(1.208 0.010,1.479 0.011) for the highest and lowest mass
bins, respectively. These estimates of the bias were used along with
the ensemble average number densities in the mass bin to generate the
theoretical predictions for the signal and its variance.

Considering Fig.~ in more detail, we note that on
the largest scales, k 0.01 , the amplitudes of the
fractional variances for all spectra are roughly equivalent. For the
auto-spectra this agreement is simply a consequence of the fact that
when the signal is dominated by the sample variance, the fractional
errors in the spectra scale as _P/P = (2/N_k)^1/2
^-1/2 (dashed lines in the figure). However as we noted earlier,
for the cross-spectrum, this near agreement also implies r_AB
1.

For the matter power spectrum (bottom panel in
Fig.~), we see that this simple scaling appears to
be preserved all the way to k 0.2 , and here the errors
are of the order 1\
broken and there is an excess of variance. This excess is not
explained by the simple addition of the usual Poisson sampling error
term (c.f. Eq.~), nor by the
addition of the extra shot-noise terms from the full counts-in-cells
covariance (c.f. Eq.~). However, in
making these predictions, we have ignored all sources of variance
generated through the nonlinear gravitational mode-coupling and it is
likely that the excess error can be attributed to these
.

figure*

[width=8.5cm]FIGS/CovPowMM.NoShotCorr.eps
[width=8.5cm]FIGS/CovPowMM.ShotCorr.eps
Mass-Mass power correlation matrices measured from the
zHORIZON simulations. Left panel: result before
shot-noise correction. Right panel: result after shot-noise
correction.

figure*

Considering the halo-mass cross-power spectra (middle panel in
Fig.~), we find that the scaling with the number of
modes is broken on slightly larger scales than for matter
(k 0.1 ). At this point the fractional error is of the order
2\
qualitatively described by Eq.~(,
solid line), although the error in the high-mass sample (red empty and
filled circles) is slightly overpredicted. The additional source of
variance in Eq.~() does not change the
predictions in any noticeable way. On smaller scales, (k>0.1 ),
the fractional error drops to 1\
than the error in the mass-mass spectrum. The excess theoretical error
suggests that haloes and dark matter are not independent samples (as
in sampling case i from ), more that haloes are
some `special' sub-sampling of the mass (similar to case ii), since we
expect the Gaussian error to be an underestimate. This leads us to
speculate that the halo-mass spectra also require a shot-noise
correction.

Considering the halo-halo spectra (top panel of
Fig.~), we show results obtained with (solid
symbols) and without (open symbols) the standard shot-noise
subtraction. This clearly demonstrates the importance of this
correction for this sample. In the case of the uncorrected spectra,
it appears that the errors follow the scaling with the number of modes
to high wavenumbers (k 0.1 ), where the error is of the
order 2\
predictions from Eq.~()
significantly over-predict the error, especially for the low-mass halo
sample. However, after shot-noise subtraction, the sample variance
scaling is actually broken on larger scales than for the
cross-spectra, and the fractional error is of the order
4-5\
predictions provide a reasonable description of the variance and, as
for the case of the matter-matter power spectrum, are an
underestimate. If we now include the additional sources of variance
from the full counts-in-cells covariance, as given by
Eq.~(), then we now see that there is a
significant increase in the errors for scales k>0.1 . We have
again neglected the gravitational model coupling variances, but it
appears that most of the shape of this distribution is well captured
by the non-Gaussianity of the sampling procedure. On comparison with
Anguloetal2008a, we find a slight disagreement, in that the
Gaussian plus Poisson sampling model appears in reasonable agreement
with the measurements.

Finally, we emphasize the fact that the fractional errors associated
with the cross-power spectra are more than a factor 2 times
smaller than the corresponding errors for the halo auto-spectra on
scales k 0.1 . Thus for experiments that wish to measure, for
instance, galaxy bias as a function of luminosity, halo mass or galaxy
type, then one may gain a significant increase in through use of
the cross-correlation approach. The caveat being that the off-diagonal
errors of the covariance matrix of the cross-power spectrum should be
small. We shall now explore this issue.

figure*

[width=8.5cm]FIGS/CovPowHH.Hi.NoShotCorr.eps
[width=8.5cm]FIGS/CovPowHH.Lo.NoShotCorr.eps

[width=8.5cm]FIGS/CovPowHH.Hi.ShotCorr.eps
[width=8.5cm]FIGS/CovPowHH.Lo.ShotCorr.eps
Halo-Halo power spectrum correlation matrices measured
from the zHORIZON simulations. Top panels: results
for power spectra without any correction for shot-noise.
Bottom panels: results after shot-noise correction. Left
column: results for the cluster mass halo sample
(M>10^14 ). Right column: results for group mass
haloes (10^13>M[ ] >1.38 10^13).

figure*

Results: Mass-mass band-power correlation matrices

In Fig.~ we present the correlation matrices for
the mass-mass power spectrum as measured from the zHORIZON
simulations, where the correlation matrices are obtained from,

C[k_i,k_j]= C[k_i,k_j]
C[k_i,k_i]C[k_j,k_j]\ .

For the correlation matrices, it was necessary to re-bin the power
spectra. This owed to the fact that when the power is averaged in
shells of thickness the fundamental mode, there are insufficient
numbers of modes on large scales to produce a good
. We therefore chose to re-bin the power by a
factor of 4, and with the contribution from each k-shell being
weighted by the number of modes in that shell. Lastly, we box car
smoothed the matrices with a width of two pixels.

In the left panel of Fig.~ we show the
correlation matrices obtained from the power spectra without any
shot-noise correction. It can clearly be seen that, going from large-
to small-scales, there is a build up of power correlations between
neighbouring modes and for the smallest scales considered, the matrix
appears perfectly correlated ( C=1). In the right panel we
show the same, but this time the matrix was generated form the
shot-noise corrected power spectra. There are only small
differences. It is likely that this result owes to the combination of
two facts: firstly, the number density of dark matter particles is
sufficiently high to render the shot-noise contributions to the
covariance of negligible importance
(c.f. Fig.~); secondly there is no variation in
the number density of dark matter particles between realizations that
might introduce additional variance (the importance of this will
become clear in the next subsections). Therefore it is likely that the
correlations are purely derived from the the gravitational model
coupling [For a recent and detailed study of the matter power
spectrum covariance arising due to gravitational instability
see][]Takahashietal2009.

figure*

[width=8.5cm]FIGS/CovPowHM.Hi.eps
[width=8.5cm]FIGS/CovPowHM.Lo.eps
Halo-Mass cross-power spectrum correlation matrices
measured from the zHORIZON simulations. Left panel:
results for a cluster mass halo sample (M>10^14 ). Right
panel: results for a group mass halo sample (10^13>M[ ]
>1.38 10^13).

figure*

Results: Halo-halo band-power correlation matrices

Fig.~ presents the results for the halo-halo
auto-power spectrum correlation matrices. The top two panels show the
results obtained from the power spectra without shot-noise
corrections. The left panel shows results for cluster mass haloes
(M>10^14 ) and the right for group mass haloes
(10^13>M[ ] >1.38 10^13). We see that the degree of
correlation appears strongly dependent on both the halo mass range
considered and also the scale considered, with the high mass halo
sample having significantly stronger off-diagonal correlations than
for the lower mass sample for a given scale. Both matrices show
significantly more correlation than was found for the dark matter.

In the bottom two panels of Fig.~, we show the
same matrices, but this time constructed from the shot-noise corrected
power spectra. The difference is remarkable -- the strong off-diagonal
correlations that are present in the upper panels has been almost
completely suppressed. The shot-noise corrected covariance matrix may
be written in terms of the shot-noise uncorrected covariance as:

C^c_ [k_i,k_j] & = &
<
( P^d_ (k_i)- 1 _ )
( P^d_ (k_j)- 1 _ )
>
& - &
<
P^d_ (k_i)- 1 _
>
<
P^d_ (k_j)- 1 _
> \ ,

& = & C^d_ [k_i,k_j]-
Covar [ 1 _ , P^d_ (k_i) ]
& - &
Covar [ 1 _ , P^d_ (k_j) ]+
Var [ 1 _ ]


If the number density of the tracer sample does not vary between
realizations, then the shot corrected and un-corrected covariance
matrices are identical. However, if it does then we see that there are
additional sources of covariance that are introduced due to the
coupling between the amplitude of the halo-halo power spectrum and the
mass function of haloes, and from the variance of the number density.
In order for the subtraction of shot-noise to result in a diagonal
correlation matrix, it requires that the cross-correlation between the
halo number counts and the halo power spectrum cancel with the
off-diagonal contributions to C^d_ [k_i,k_j]. It is beyond the
scope of this current work to illuminate this issue further and it
shall remain as a topic for future investigation. One caveat to the
above results, is that it is well known that the standard shot-noise
correction is too strong for haloes, since it results in negative
power on small scales . It is therefore likely
that this will have some impact on the covariance matrix.

Lastly, we now see that for the matter power spectra, since the number
density of dark matter particles does not vary between realizations,
then we must have C^c_ [k_i,k_j] =
C^d_ [k_i,k_j].

Results: Halo-mass band-power correlation matrices

In Fig.~ we show the correlation matrices for
the halo-mass cross-power spectra. The left panel shows results for
cluster mass haloes (M>10^14 ) and the right for group mass
haloes (10^13>M[ ] >1.38 10^13). Similar to the halo
auto-power correlation matrix, we see that the degree of correlation
appears strongly dependent on both halo mass and scale. Interestingly,
we note that whilst the spectra from the high-mass sample show more
band-power correlation than for the dark matter, the lower mass halo
sample appears to show less. This further recommends the cross-spectra
approach for further investigation as an improved estimator for
large-scale structure.

All of the above matrices serve to warn us that, whilst the Gaussian
plus Poisson model describes the diagonal errors reasonably well, it
fails to capture the build up of correlations between Fourier
modes. To describe the above results one must model both the full
non-Gaussian trispectrum generated by gravitational mode-coupling
and, as we have shown
in this paper, the covariance introduced by the point sampling for the
mass tracers.

figure*

[width=13cm]FIGS/Error_MM_HM_HH_Real.ps
Comparison of the fractional variance of mass and halo
correlation functions as measured from the zHORIZON
simulations with theoretical predictions. Similar to
Fig.~, the three panels show the standard deviation
in the bin averaged correlation functions, ratioed to the mean
correlation function, as a function of the spatial scale. From top to
bottom the panels show results for the halo-halo, halo-mass and
mass-mass correlations. Symbols show estimates measured from the
N-body simulations. In the top two panels, the (red) point symbols
and the (blue) star symbols denote haloes with masses in the range
(M>1.0 10^14 ) and
(1.0 10^13<M[ ]<2 10^13), respectively. Again, the
solid lines represent the theoretical predictions from the Gaussian
plus Poisson sampling theory. Dash lines represent the pure Gaussian
predictions.

figure*

Results: band-correlation function variances

As a final study we now consider the correlation function errors. The
main advantage of the configuration space is that the constant
shot-noise correction, which is necessary for the power spectra are
not required here. This follows from the fact that the Fourier
transform of a constant gives a delta function at zero lag. However,
as was described in , the shot-noise corrections do
affect the correlation function errors.

In Figure~ we present measurements from the ensemble
of zHORIZON simulations for the fractional errors on the
mass-mass (bottom panel), the halo-mass (middle panel) and the
halo-halo (top panel) correlation functions. Again, we only show
results for the highest and lowest bins in halo mass. The correlation
functions were generated using the DualTreeTwoPoint code, which
is a parallel, tree-based algorithm and is described more fully in
Smith et al. (in preparation). For the dark matter sample, we used
roughly 4 10^6 particles, sub-sampled from the available
4 10^8 for each estimate.

The main result to note from this analysis is that, whilst for the
power spectrum on large scales the fractional error is the same
irrespective of tracer, this is not the case for the correlation
function. We note that for r>20 , the halo-mass cross-correlation
appears to be a more efficient estimator than the simple
auto-correlation function, by almost a factor of 2. To make this
statement more concrete we should include the off-diagonal errors in
the calculation of . However, from our discussion in
, we expect that the off-diagonal errors are also
reduced. We shall reserve this for a future work.

Another important point to note, is that in nearly all cases the
theoretical predictions for the Gaussian plus Poisson sampling error
estimates are an underestimate of the measured errors, especially on
scales (r<20 ). The predictions being worst for the
auto-correlation function for the high mass halo sample, and this is
in agreement with the power spectrum results from the previous
section.

The errors in the auto-correlation functions were previously
investigated in numerical simulations by and
Sanchezetal2008, who showed that the Gaussian plus Poisson
model provided a good description at the scale of the Baryonic
Acoustic Oscillations (r 100 ). Our results extend this
analysis to the cross-correlation functions. Also, the range of
investigated scales is extended to smaller scales by more than one
order of magnitude.

Conclusions

In this paper we have performed a detailed investigation of the errors
associated with auto- and cross-power spectra and also the
cross-correlation function of different tracers of the density field.

In we developed the counts-in-cells approach
for a multi-tracer approach to the clustering statistics. We showed
that not all cross-power spectra are free from a shot-noise
correction, and that the precise correction one should apply depends
on the sampling distribution function.

In we gave a derivation of the full
non-Gaussian covariance matrix for the cross-power spectrum, including
all the sources of variance that arise from the Poisson sampling of
the mass tracers and this extends the standard results
.
We showed that, for the case of Poisson sampling of Gaussian
fluctuations, there were terms that contributed to the off-diagonal
terms of the covariance matrix. We showed that in the small-scale
limit k these terms dominate over all other sources
of variance (including Non-Gaussian terms generated from gravitational
mode-coupling) and the covariance matrix becomes perfectly correlated.

In we investigated the efficiency of the
cross-power spectrum. We used the relative signal-to-noise ( )
ratio of two different estimators as a diagnostic for efficiency. For
the case where a high-density sample of tracers was cross-correlated
with a low-density sample, it was shown that the former approach was a
more efficient estimator than the case where one simply
auto-correlates the low-density sample. As an example, we showed that
for the determination of cluster bias, the cross-power spectrum
approach would yield significant gains in . Other uses are
improving estimates of the luminosity dependence of galaxy bias.

In we explored the covariance of auto- and
cross-correlation functions. It was shown that whilst the correlation
function covariance matrix in general is not diagonal, the
discreteness terms that led to off-diagonal covariance in the power
spectrum do not generate off-diagonal elements in the correlation
function covariance. Thus the correlation function covariance matrix
appears easier to understand and model than the power spectrum
covariance.

In we used a large ensemble of N-body
simulations, to obtain estimates of the power spectrum and correlation
function errors. We showed for the fractional errors on the mass-mass
halo-mass and halo-halo spectra, that the numerical results were in
reasonably good agreement with the Gaussian plus Poisson sampling
model, but the measurements showed larger variance than the theory. It
was also shown that in the limit of large scales and in the case that
Poisson error is not dominant, then the fractional errors for all
spectra are equivalent, since they are simply
k^-1 ^-1/2.

We investigated the correlation matrix for the mass-mass power
spectrum, and confirmed that there were strong correlations between
different band-powers
. We
showed that correcting the spectra for shot-noise does not change
the correlation matrix significantly. We investigated the halo-halo
auto-power covariance matrix without applying a correction for
shot-noise. We showed that the degree of correlation increased with
the mass of the halo sample considered and that the matrices showed
more band-power correlation than for the dark matter. We then
estimated the covariance from the shot-noise corrected spectra and
found that the off-diagonal errors were dramatically reduced, almost
decorrelating individual band-powers. We conjectured that this arises
from the subtraction of the covariance between halo number density and
the halo-halo power spectrum and also the variance in the halo number
density. We investigated the cross-power correlation matrix for
haloes and dark matter and showed that the correlations were reduced
compared to the shot-noise uncorrected halo-halo matrices and for the
lowest-mass halo sample, were less correlated than the dark matter.
We investigated the errors in configuration space, and showed
that there was a significant gain in on all scales from using
the cross-correlation function of haloes and dark matter as opposed to
simply examining the auto-correlation function of haloes.

We conclude that, for certain cases, the cross-spectra and
cross-correlation functions are more efficient probes for the
large-scale structure, than the standard auto-spectra and
auto-correlation function approaches that are widely in use. These
cases concern studies aiming to measure: the luminosity dependence of
the galaxy bias ; the cluster
bias as a function of mass and hence constrain the degree of
primordial non-Gaussianity in the initial conditions
.

0.2cm

Acknowledgements

RES acknowledges: R.~Angulo, V.~Desjacques, C.~Porciani,
R.~Scoccimarro, U.~Seljak, and R.~Sheth for useful discussions;
A.~Saintonge for help with IDL. RES kindly thanks L. Marian for
comments on the draft. RES thanks V.~Springel for making public his
GADGET-2 code and for providing his B-FoF halo finder,
R.~Scoccimarro for making public his 2LPT initial conditions
code and U.~Seljak and M.~Zaldarriaga for making public their
cmbfast code. RES acknowledges support from a Marie Curie
Reintegration Grant, and the Swiss National Foundation. When this
paper was in the refereeing stage, two related works appeared on the
arXiv: HutsiLahav2008 and Whiteetal2008.

mn

CrossCorr.3.bbl

document

Mon.~ Not.~ R.~ Astron.~ Soc.~
Phys.~ Rep.~
Phys.~ Rev.~ D.~
Phys.~ Rev.~ Lett.~
Astrophys.~ J.~
Astrophys.~ J.~ Suppl.~
Astrophys.~ J.~ Lett.~
Astron.~ Astrophys.~
Nature (London)~
Astro-particle Phys.~
Rev.~ Mod.~ Phys.~

MNRAS
PR
PRD
PRL
ApJ
ApJS
ApJL
A\&A
Nature
Astro-particle Phys.~
Rev.~ Mod.~ Phys.~
Phys.~ Rep.~






L
F

n

Lin
NL

r_

1
2

\2D 2D

V_



F(k)

<N_i >
<N_A >
<N_B >

cyc

S/ N

T
g
h

x
r
u
k
q

cent
\1Loop 1Loop


kms^-1 Mpc^-1
h^-1M_
\, h^-1 kpc
\, h^-1 Mpc
\, h^-3 \, Mpc^3
\, h^-1 Gpc
\, h^-3 \, Gpc^3
\, h \, Mpc^-1

hh
h


S
N

1H
2H

d^3\!r
d^3\!x
d^3\!k
d^3\!q
d^3\!y



_s

_ D

k_n
L

n
n_ g
n_ h

=cmmib10
=cmmib10 scaled 833

k
x
p
q
v
u
y
k




C
M
_u

r_
r_
s_
s_

<
>
#1#2 3.6pt 0pt .9pt
=0pt#1 ## $ #2

obs
mc