emulateapj









[5] f_#1(S_#2| _#3,S_#4, _#5)

[5] f_#1(S_#2, _#3|S_#4, _#5)

[5] f_#1(S_#2, _#3;S_#4, _#5)

[3] f(S_#1 S_#2; _#3)

[1] #1

graphicx

amsmath

document

Dark matter halo merger and accretion probabilities in the excursion set formalism

Esfandiar Alizadeh
Department of Physics, University of Illinois at Urbana-Champaign, 1110 West Green Street, Urbana, IL 61801

Benjamin Wandelt
Department of Physics, University of Illinois at Urbana-Champaign, 1110 West Green Street, Urbana, IL 61801
Department of Astronomy, University of Illinois at Urbana-Champaign, 1002 West Green Street, Urbana, IL 61801
Center for Advanced Studies, University of Illinois at Urbana-Champaign, 912 West Illinois Street, Urbana, IL 61801



abstract

The merger and accretion probabilities of dark matter halos have so far only been calculated for an infinitesimal time interval. This means that a Monte-Carlo simulation with very small time steps is necessary to find the merger history of a parent halo. In this paper we use the random walk formalism to find the merger and accretion probabilities of halos for a finite time interval. Specifically, we find the number density of halos at an early redshift that will become part of a halo with a specified final mass at a later redshift, given that they underwent n major mergers, n=0,1,2,... . We reduce the problem into an integral equation which we then solve numerically. To ensure the consistency of our formalism we compare the results with Monte-Carlo simulations and find very good agreement. Though we have done our calculation assuming a flat barrier, the more general case can easily be handled using our method. This derivation of finite time merger and accretion probabilities can be used to make more efficient merger trees or implemented directly into analytical models of structure formation and evolution.

abstract

cosmology:theory-dark matter



empty

Introduction


Since the introduction of the spherical collapse model of dark matter halos by Press and Schechter and its generalizations such as extended Press-Schechter (EPS) and ellipsoidal collapse it has been used extensively in the cosmological literature as a fast and accurate method to quantify the distribution of collapsed dark matter objects in the universe. This in turn is the backbone of semi-analytic theories of galaxy formation and evolution . Modified versions of the excursion set formalism underlying EPS have also found application in different contexts such as ionized bubble growth in the early universe . The advantages of this method compared to direct N-body simulation include its superior speed, which allows the exploration of large ranges of
parameter space, and redshift range than is currently accessible to N-body simulations.

In the EPS formalism one finds the probability P(M_1,z_1|M_2,z_2)dM_1 which gives the probability of a point mass being part of a halo with mass in between M_1 and M_1+dM_1 at redshift z_1 given that it was (or will be) part of a halo with mass M_2 at redshift z_2. During this redshift interval it could merge with any number of halos whose masses add up to |M_1 - M_2|. However, from the viewpoint of galaxy formation, accretion of small halos into the larger one do not have the ability to change the evolution of the galaxy or galaxies inside it. Indeed, it is assumed that only at major mergers in which the mass of the merged halo satisfies a condition to be large enough, have this ability. It is therefore interesting to ask the question: given the criterion for a major merger, is it possible to find an analytical result to describe the progenitor distribution of a parent halo, based on how many times they have undergone a major merger? For example, what is the number density of halos at redshift, say, z=1 which underwent n major mergers, n=0,1,2,..., and eventually ended up being a galaxy halo at the present time.

Here we present an analytical method based exclusively on excursion set assumptions to find these number densities. We reduce the problem to an integral equation which can then be solved numerically. Our derivation is given in section . We show in section that Monte-Carlo (MC) simulations agree with the results of our semi-analytic model.

It is also possible to cast the integral equation into a scale invariant form. This can be a great advantage since we just need to solve the integral equation once and scale the result to find the general formula. This is done in section . We discuss how the method presented in this paper can be generalized and conclude in section .

A few appendixes are added for further clarification. Appendix gives a brief introduction to the excursion set formalism and defines our notation. In Appendix we give a straightforward method to solve the integral equation.
Finally in Appendix we describe very briefly how we implemented our Monte-Carlo simulation.


The Accretion probability



The main task of this paper is to find an analytical result for acc2211, the probability that a random walk starting from (S_1, _1) has its first upcrossing between S_2 and S_2+dS_2 at the barrier height _2 given that it never had a jump larger than M_res between _1 and _2. Here S= ^2(M) is the rms mass fluctuation inside spheres of mass M, and is a monotonically increasing function of redshift which for the case of an EdS universe takes the familiar form of 1.68 (1+z) [ ] [ ]For further explanation of excursion set formalism, see Appendix . In order to accomplish this we let a number of random walks start from (S_f, _f) (see fig. ), where in this paper S_f and _f denote ^2(M_f) and (z_f) respectively, and so forth for other subscripts. Setting a barrier at _i> _f, that is at earlier times, we know the fraction of random walks that have their first upcrossing in the interval (S_i,S_i+dS_i), regardless of whether they accrete or merge, is (see equation ):




& & totiiff\,dS_i
& = & ( _i - _f)(2 )^1\!/2(S_i-S_f)^3/2 [- ( _i- _f)^22(S_i-S_f) ] \,dS_i

The next step is to notice that the fraction of random walks that start from (S_f, _f) and have their first upcrossing between S_i and S_i+d\,S_i at the height _i and have one and only one jump from S_1 to S_2 during the interval and +d is:

&& acc1ff \,dS_1 \ 12 \,dS_2 \,d
& & accii2 \,dS_i ,

where 12\,dS_2 \,d is the probability that a random walk will have a sudden jump from S_1 to somewhere between S_2 and S_2+dS_2 in an infinitesimal interval d . Its form for the Spherical collapse model is given by equation .

Now, if we integrate over all S_1, S_2 and keeping in mind that M(S_1)-M(S_2) must be larger than M_res to be classified as a merger, we find the fraction of walks that have undergone one and only one merger to be:


& & 1mergeriiff= _ _f^ _i \!\,d _S_f^S_i- ' (S_i) \! \,dS_1 _S_1+ (S_1)^S_i \,dS_2
& & acc1ff 12 accii2
& &


Here (S_1)= ^2(M(S_1)-M_res)-S_1 is the closest distance that S_2 can be brought to S_1 and still have a jump large enough to be considered as a merger. Analogously define ' (S_i)=S_i- ^2(M(S_i)+M_res).

We can similarly find the fraction of random walks that have undergone two and only two mergers, 2mergersiiff. We get an expression like equation but with six integrations, and higher terms involve more integrations yet.
Adding all of these terms must give:

& & totiiff= acciiff+
& & 1mergeriiff+ 2mergersiiff+
& &

which says that the fraction of random walks starting from (S_f, _f) and passing through a barrier at _i for the first time between (S_i,S_i+dS_i), no matter what happened during their journey, is equal to the sum of the fractions of walks which underwent no mergers, one merger, two mergers, etc.

Putting the integral formulae for 1mergeiiff and higher order terms into equation~, we will find an integral equation for the unknown acciiff. However, this equation written in this form is not computationally tractable since higher order terms will require a prohibitive number of integrations.

Note that the conditional probability densities in Eq.~() are analogous to propagators. It is instructive to visualize each term in equation~ using a diagrammatic notation, as in Fig.~.
The figure makes it clear that this equation expands the full propagator in terms of bare propagators (the accretion probability) with interactions (mergers). We can use this insight to rearrange the above equation as in the figure, which shows that one can resum the terms in Eq.~() to write down a tractable integral equation.


Writing the second equality of figure in the language of equation , we find the important result:

& & totiiff= acciiff +
& & _ _f^ _i \!\,d _S_f^S_i- ' (S_i) \! \,dS_1 _S_1+ (S_1)^S_i \,dS_2
& & acc1ff 12 totii2

This is a Voltera integral equation which we will solve numerically.
We refer the interested reader for a discussion of solving this equation numerically to appendix . In the next section we compare these semi-analytic results to Monte-Carlo simulations.


comparison with Monte-Carlo simulation

There are several methods for generating a merger tree using Monte-Carlo techniques (see SK and Cole). Here we choose to use a binary merger tree with accretion method mainly due to its simplicity of implementation. In this scheme the time interval is chosen to be so small that the probability of a merger is very low. This in turn ensures that the probability of more than one merger is negligible in a given time step. Then a halo one time step back will have a smaller mass due to accretion or division into two progenitors. The details of the method can be found in Appendix .

It should be noted that our Monte-Carlo (MC) simulation gives number weighted probabilities. However, f_acc in formula is a mass weighted probability. We can easily change f_acc to a number weighted probability p_acc using p_acc= M_fM f_acc.



Each panel of figure shows p_acc versus S_i for a different lookback redshift z_i, with parent mass M_f=2 10^12 M_ and redshift z_f=0. The mass resolution is fixed at M_res= M_f10. The dashed line is our analytical solution, the histogram shows the result of the MC simulation and the solid line is f_tot given by equation . We see an excellent agreement between the MC simulation and our analytic result, and notice some intuitively sensible trends in the figures that are worth mentioning. First, p_acc=p_tot for S_i<4.1. That is because to have a merger we need M_i M_f-M_res=1.8 10^12, which corresponds to S_i=4.1. For S_i smaller than this, the mass jump is always less than mass resolution and only accretion can happen; hence, p_acc=p_tot in this region. For S_i larger than 4.1 mergers are allowed, so the probability of having one or more merger is non-zero and p_acc will be less than p_tot. Also, the probability of having at least one merger, p_tot-p_acc, increases monotonically with increasing redshift as more and more halos have a chance to undergo a merger. Finally, as we look further back in time, halos with smaller masses have a chance to reach M_f by just accreting so p_acc spreads to smaller masses with increasing redshift.




In figure we show p_acc vs. S_i with the same M_f and z_f as above, but here we look at the distribution with different choices of M_res at a fixed lookback redshift z_i=0.5. Again the agreement between our analytical result and the MC simulations is very good. Again, there are some intuitively reasonable trends in the figure that should be noted. As we discussed above, p_acc must be equal to p_tot for M_i M_limit=M_f-M_res. As M_res gets smaller, this limiting mass becomes larger. Therefore S_limit=S(M_limit), the S_i below which p_acc=p_tot, becomes smaller, which can easily be seen in the figure. Notice that different panels have different scales. Also given a fixed lookback redshift, decreasing the mass resolution increases the number of events we classify as mergers thus raising the probability for a halo to have at least one merger. Since p_tot is not affected by the choice of M_res, p_acc accordingly decreases with decreasing M_res.



Scaled solution

In general, for any given prescription for M_res one can find the solution of integral equation to obtain acciiff. Generally, this needs to be solved for each given final halo mass M_f. However, if we impose a special mass resolution for a chosen cosmology it is possible to cast the integral equation into a scale invariant form. Then we need only solve this equation once.
To achieve this, we need to define M_res so as to satisfy the following two equations simultaneously:


(S) ^2 (M(S)-M_res)-S = C S


and


'(S) S - ^2(M(S)+M_res) = C' S

where C and C' are constants independent of S. Recall that (S) and '(S) appear in the limits of integration of equation . For M_res small compared to M(S) we can easily see, by Taylor expansion, that to second order in M_res/M these equations can be satisfied if we take C=C' and the mass resolution as

M_res(S)=- SdS/dM C.

For example for a scale invariant matter power spectrum with power index n, P(k) k^n, the above equation gives

M_res= n+33 C M_parent


i.e. a merger is defined when the mass of any progenitor of the halo is larger than a constant fraction of the parent mass Note that more general solutions exist if C C' which can possibly be used to loosen the relationship between M_res and M_parent. It seems physically reasonable to choose M_res much smaller than and proportional to M_parent which is the case when C=C'. .

With this criterion for M_res we are ready to rewrite the integral equation in a scale invariant form. To do so we define the new variables


& & u S/S_f
& & ( - _f)/S_f^1/2


and the functions f_acc and f_acc:

& & acc1ff = S_f^-1 f_acc ( S_1S_f | - _fS_f^1/2 )
& & f_acc (u_1 | ) = (2 )^1/2 (u_1-1)^3/2 (- ^22(u_1-1) ) f_acc(u_1 | )
& &



With these definitions equation can be written in the manifestly scale invariant form

1=& & f_acc (u_i| _i) + _0^ _i \!\,d _1^u_i(1-C) \! \,du_1 _u_1(1+C)^u_i \,du_2
& & f_acc (u_1| )K( _i,u_i,u_1,u_2, )



where the kernel for the spherical collapse model is


& & K= (2 )^1/2 (u_i-1)^3/2 _i _i^22(u_i-1)
& & (2 )^1/2(u_1-1)^3/2 - ^22(u_1-1)
& & 1(2 )^1/2(u_2-u_1)^3/2 ( _i - )(2 )^1/2(u_i-u_2)^3/2 -( _1- )^22(u_i-u_1)
& &

For a given C this equation can be solved for f_acc(u| ). This calculation can be facilitated by noticing that the integral over S_2 can be done analytically. Having found f_acc(u| ) one can find acc11ff for arbitrary S_1, _1, S_f and _f using equations .

The result of this calculation for a power law matter power spectrum with n=-1 and C=0.01 is shown in figure ~. The solid line, as usual, denotes p_tot, the lighter histogram in each panel indicates the result of MC simulation for p_acc and the dashed line on top is our numerical solution of equation scaled according to equation . The panels from top-left to bottom right are for - _f =0.2, 0.3, 0.4 and 0.5. Assuming =1.69 (1+z) and z_f=0 these correspond to lookback redshifts 0.118, 0.178, 0.237 and 0.296 respectively. One can see that the agreement is very good for all redshifts considered.

The darker histogram in figure shows the result of our MC simulation for p_1merger(S_i, _i,S_f, _f). This is the number density of halos in a given range (S_i,S_i+d S_i) that have a parent halo of mass corresponding to S_f at time _f and have merged once in their journey from _i to _f. Now that we have found f_acc it is possible to calculate p_1merger(S_i, _i,S_f, _f) using equation . p_1merger is nothing but f_1merger multiplied by M_fM to convert from mass density to number density. This result is shown by the dot-dashed line on top of the histogram. The match is very good.
As expected, for small z the probability of one merger is much smaller than probability of accretion, which can be seen in the top-left plot. Also in this plot, we can see that the tail of the distribution p_1merger approaches p_tot. This says that the probability of having more than one merger is negligible for small z, as expected.

On the other hand, when z gets larger more and more halos have a chance to merge, so p_acc flattens and p_1merger rises. Also, with a large z there is a finite probability of having more than one merger since the tail of p_1merger is considerably below p_tot. One can continue this calculation and find p_2mergers, p_3mergers and so on, which we have not shown here. Where this hierarchy should be terminated clearly depends on how far we look back in time: a larger z means more chance of a merger and therefore requires higher merger terms.






discussion and conclusion

We have used the random walk formalism to find the accretion probability, i.e. the probability for a parent halo to have a progenitor in a given mass interval at a given earlier time given that it has not merged with a halo of a mass larger than the mass resolution. As a concrete example we have worked out the accretion probability in the special case where the barrier is flat, the mass resolution is constant and we look backward in time. However this method can be extended to solve more general problems.

For example, while we have used a constant barrier, it is well known that this barrier shape does not match the results of N-body simulations. However, our formalism can be generalized to the case of a moving barrier, which has proven to give a very good match to N-body simulations. One only needs to find the appropriate formulae for f_tot and 12 for the moving barrier and solve the integral equation . These functions can in general be found numerically, using for example the method of Zhang. However there are analytical results for simple barriers that reproduce the results of N-body simulations, e.g. the square root barrier . Since the aim of this paper is not to compare with numerical simulations, we will leave this calculation for future work.



Here we have always looked backward in time. However, in certain cases it might be more convenient to find f_acc in the forward sense. In that case it gives the probability of a halo at an early time being accreted by a larger halo in a given mass interval. This problem can be solved with our formalism by using the forward form of equation , with the forward form of f_tot and f_merge . Given a population of objects of mass M at time t, some of these objects will be destroyed in the course of their evolution by merging with other objects. To find the fraction of objects that have survived from the initial time to the observation time [see][for the case of clusters of galaxies]Verde we need to find the fraction of objects whose halos have not merged with halos more massive than a given threshold; in other words they have only accreted from the initial redshift to the redshift of observation. This is precisely what our formalism calculates.

Finally, this method can lead to a major improvement in the speed of merger tree generation in Monte-Carlo simulations. Since there was no formula for the accretion or merger probabilities in a finite time interval, past MC codes had to use infinitesimal time-steps to be able to use the known formula for merger probabilities (eqn. ), making the computation very time consuming. In this paper we have presented methods to calculate the accretion and merger probabilities for any given time interval which can be used to generate trees with larger time-steps and hence in less computational time.

Acknowledgment
EA thanks Laura Book for her comments and aid in manuscript preparation and Akbar Jaefari for his helpful discussion.
We acknowledge Andrew Benson for his reading of the manuscript and useful suggestions.
BDW acknowledges the Friedrich Wilhelm Bessel prize from the Alexander von Humboldt foundation. This work was partially supported by an Arnold O.~ Beckman award from the University of Illinois.

apj